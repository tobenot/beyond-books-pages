"use strict";(self["webpackChunkbeyond_books_vue"]=self["webpackChunkbeyond_books_vue"]||[]).push([[7321],{7321:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var a=r(4048),n=r(388),o=(r(2675),r(9463),r(8706),r(113),r(1629),r(4114),r(2010),r(6099),r(3500),r(641)),l=r(33),s=r(953),c=r(3751),i=r(6278),u=r(5220),d=r(6992),v=r(9410),h={class:"min-h-screen w-screen bg-gradient-to-r from-white to-tech-light overflow-hidden"},m={class:"relative z-10 flex flex-col h-screen w-full pb-safe"},p={class:"flex-none pt-4 md:pt-8 px-4 md:px-8"},f={class:"flex justify-between items-center"},k={class:"text-3xl font-bold text-tech-primary"},x={class:"text-tech-secondary mt-2"},w={class:"flex-1 relative flex items-center justify-center min-h-0"},g={class:"relative w-[17.5rem] h-[26.25rem] md:w-[50rem] md:h-[37.5rem]"},b=["onClick"],y=["src","alt"],L={class:"flex-none pb-4 md:pb-8 px-4 md:px-8"},C={class:"text-center space-y-2 md:space-y-4"},_={class:"text-xl md:text-2xl font-bold text-tech-primary"},S={class:"text-sm md:text-base text-tech-secondary max-w-2xl mx-auto"},M={class:"flex justify-center mt-4 md:mt-8"},j=["disabled"];const E=Object.assign({name:"CharacterSelectView"},{__name:"CharacterSelectView",setup:function(e){var t=(0,i.Pj)(),r=(0,u.rd)(),E=(0,d.s9)(),I=E.t,P=(0,s.KR)(!1),R=(0,o.WQ)("$modal"),W=(0,o.EW)((function(){var e;return(null===(e=t.state.sections.scenarioConfig)||void 0===e?void 0:e.characters)||[]})),K=(0,o.EW)({get:function(){var e,r=(null===(e=t.state.sections.scenarioConfig)||void 0===e?void 0:e.characters)||[],a=t.state.gameState.selectedCharacter;return a?r.find((function(e){return e.name===a})):r.find((function(e){return e.isDefault}))||r[0]},set:function(e){A.value=e}}),A=(0,s.KR)(null),F=function(e){A.value=e,P.value=!1},X=function(e){return e.portraitPath?v.u.getImageUrl("".concat(e.portraitPath,".png")):v.u.getImageUrl("default-character.png")},z=(0,o.EW)((function(){return!t.getters["save/hasSave"]})),B=function(){var e=(0,n.A)((0,a.A)().mark((function e(){var n;return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(K.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.dispatch("gameState/changeCharacter",K.value.name);case 5:if(n=t.state.sections.currentScenario,!z.value){e.next=11;break}return e.next=9,t.dispatch("save/loadScenarioSave",n);case 9:return e.next=11,t.dispatch("save/saveSave");case 11:return e.next=13,t.dispatch("sections/loadSectionsIndex");case 13:console.log("".concat(z.value?"新游戏":"继续游戏","角色选择完成")),r.push("/sections"),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](2),console.error("角色选择失败:",e.t0),R.show("error",{title:I("error"),content:I("characterSelectError"),type:"normal"});case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),V=function(){z.value&&t.dispatch("save/clearSave"),r.push("/")},D=(0,s.KR)(0),Q=function(e){var t,r,a=W.value.length,n=360/a*e+D.value,o=window.innerWidth<768?7.5:15.625,l=Math.cos(n*Math.PI/180)*o,s=Math.sin(n*Math.PI/180)*o,c=(null===(t=A.value)||void 0===t?void 0:t.id)===W.value[e].id?1.2:.8;return{transform:"translate(".concat(l,"rem, ").concat(s,"rem) scale(").concat(c,")"),zIndex:(null===(r=A.value)||void 0===r?void 0:r.id)===W.value[e].id?10:1}},T=function(){D.value+=360/W.value.length,J()},U=function(){D.value-=360/W.value.length,J()},J=function(){var e=W.value.length,t=Math.round(-D.value/(360/e))%e,r=t<0?e+t:t;F(W.value[r])};return(0,o.sV)((function(){A.value=K.value,W.value.forEach((function(e){e.portraitPath&&v.u.preloadImage("".concat(e.portraitPath,".png"))}))})),function(e,t){var r,a;return(0,o.uX)(),(0,o.CE)("div",h,[t[3]||(t[3]=(0,o.Lk)("div",{class:"fixed inset-0 bg-white z-0"},[(0,o.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-tech-light opacity-50"})],-1)),(0,o.Lk)("div",m,[(0,o.Lk)("div",p,[(0,o.Lk)("div",f,[(0,o.Lk)("h2",k,(0,l.v_)((0,s.R1)(I)("game.selectCharacter")),1),(0,o.Lk)("button",{onClick:V,class:"flex items-center gap-2 text-tech-primary hover:text-tech-primary/80 transition-colors"},[t[0]||(t[0]=(0,o.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),(0,o.eW)(" "+(0,l.v_)((0,s.R1)(I)("common.returnToMenu")),1)])]),(0,o.Lk)("p",x,(0,l.v_)((0,s.R1)(I)("game.selectCharacterDesc")),1)]),(0,o.Lk)("div",w,[(0,o.Lk)("div",g,[(0,o.bF)(c.F,{name:"character-rotate"},{default:(0,o.k6)((function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(W.value,(function(e,t){var r,a;return(0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:(0,l.Tr)(Q(t))},[(0,o.Lk)("div",{class:(0,l.C4)(["character-frame",{active:(null===(r=K.value)||void 0===r?void 0:r.id)===e.id}]),onClick:function(t){return F(e)}},[(0,o.Lk)("img",{src:X(e),alt:e.name,class:(0,l.C4)(["w-[8.75rem] h-[13.125rem] md:w-[12.5rem] md:h-[18.75rem] object-cover",{"opacity-50":(null===(a=K.value)||void 0===a?void 0:a.id)!==e.id}])},null,10,y)],10,b)],4)})),128))]})),_:1})]),W.value.length>1?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("button",{onClick:T,class:"absolute left-0.5rem md:left-1rem top-1/2 -translate-y-1/2 text-tech-primary hover:text-tech-primary/80 transition-colors"},t[1]||(t[1]=[(0,o.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-2rem w-2rem md:h-3rem md:w-3rem",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),(0,o.Lk)("button",{onClick:U,class:"absolute right-0.5rem md:right-1rem top-1/2 -translate-y-1/2 text-tech-primary hover:text-tech-primary/80 transition-colors"},t[2]||(t[2]=[(0,o.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-2rem w-2rem md:h-3rem md:w-3rem",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))],64)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",L,[(0,o.Lk)("div",C,[(0,o.Lk)("h3",_,(0,l.v_)(null===(r=K.value)||void 0===r?void 0:r.name),1),(0,o.Lk)("p",S,(0,l.v_)(null===(a=K.value)||void 0===a?void 0:a.description),1),(0,o.Lk)("div",M,[(0,o.Lk)("button",{onClick:B,disabled:!K.value,class:"w-full md:w-auto px-6 md:px-8 py-3 bg-tech-primary text-white rounded-xl shadow-tech transition-all duration-300 hover:bg-tech-primary/90 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed"},(0,l.v_)((0,s.R1)(I)("game.startJourney")),9,j)])])])])])}}});var I=r(6262);const P=(0,I.A)(E,[["__scopeId","data-v-ff6eb992"]]),R=P}}]);