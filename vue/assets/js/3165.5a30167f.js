"use strict";(self["webpackChunkbeyond_books_vue"]=self["webpackChunkbeyond_books_vue"]||[]).push([[3165],{3165:(e,t,r)=>{r.r(t),r.d(t,{default:()=>oe});var a=r(4048),n=r(9258),s=r(388),l=(r(2675),r(9463),r(8706),r(2008),r(113),r(4114),r(6910),r(2010),r(6099),r(641)),o=r(33),c=r(953),i=r(6278),u=r(5220),d=r(6992),v=r(9410),f=r(1034),h=(r(2259),r(6280),r(6918),r(4346),r(7764),r(2953),r(2635));function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=(0,h.A)(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){o=!0,s=e},f:function(){try{l||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}var x={scenarios:[{id:"silver_moon",path:"scenarios/silver_moon",category:"main",order:1}],loadAllScenarios:function(){var e=this;return(0,s.A)((0,a.A)().mark((function t(){var r,n,s,l,o,c;return(0,a.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,r=[],n=p(e.scenarios),t.prev=3,n.s();case 5:if((s=n.n()).done){t.next=20;break}return l=s.value,t.prev=7,t.next=10,v.u.loadJSON("".concat(l.path,"/config.json"));case 10:o=t.sent,c=(0,f.A)((0,f.A)((0,f.A)({},o),l),{},{coverPath:"".concat(l.path,"/thumbnail"),coverLargePath:"".concat(l.path,"/cover")}),r.push(c),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](7),console.error("加载剧本 ".concat(l.id," 失败:"),t.t0);case 18:t.next=5;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](3),n.e(t.t1);case 25:return t.prev=25,n.f(),t.finish(25);case 28:return r.sort((function(e,t){return e.order-t.order})),t.abrupt("return",r);case 32:return t.prev=32,t.t2=t["catch"](0),console.error("加载剧本列表失败:",t.t2),t.abrupt("return",[]);case 36:case"end":return t.stop()}}),t,null,[[0,32],[3,22,25,28],[7,15]])})))()},register:function(e){this.scenarios.push(e)}},b={loadAllScenarios:function(){return(0,s.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",x.loadAllScenarios());case 1:case"end":return e.stop()}}),e)})))()}},m={class:"min-h-screen bg-gradient-to-r from-white to-tech-light overflow-hidden"},g={class:"relative z-10 flex w-screen h-screen overflow-hidden"},k={class:"w-[65%] h-full relative flex flex-col"},w={class:"absolute inset-0"},y=["src","alt"],L={class:"relative flex-1 p-8 flex flex-col"},_={class:"flex-1 flex flex-col justify-end space-y-6 max-w-2xl"},A={class:"text-4xl font-bold text-tech-primary"},C={class:"text-lg text-tech-secondary"},S={key:0,class:"flex flex-wrap gap-2"},E={key:1,class:"text-tech-secondary"},I={class:"font-medium"},R={key:2,class:"text-tech-secondary space-y-1"},X={class:"font-medium"},j={key:0,class:"text-sm"},P={class:"font-medium"},T={class:"flex-none mt-4 mb-20"},U={class:"space-y-4"},z={class:"font-medium text-tech-secondary"},N={class:"flex flex-wrap gap-4"},K={class:"text-6xl mb-2"},F={class:"text-sm whitespace-nowrap"},Q={class:"fixed bottom-12 left-1/2 -translate-x-1/2 z-50"},M=["disabled"],O={class:"w-[35%] h-full bg-white/80 backdrop-blur-sm"},V={class:"h-full flex flex-col"},W={class:"flex-none p-4 border-b border-gray-200 flex justify-between items-center text-responsive"},B={class:"text-xl font-bold text-tech-primary"},D={class:"text-responsive-sm"},J={class:"flex-1 overflow-y-auto custom-scrollbar"},q={class:"p-4 space-y-6"},G={class:"flex items-center justify-between"},H={class:"text-responsive-lg font-medium text-tech-primary"},Y={class:"text-responsive-sm text-tech-secondary"},Z={class:"space-y-2"},$=["onClick"],ee={class:"flex items-center gap-4"},te={class:"w-32 h-32 flex-none rounded-xl overflow-hidden"},re=["src","alt"],ae={class:"flex-1 text-2xl font-medium text-tech-primary text-center"};const ne=Object.assign({name:"ScenarioSelectView"},{__name:"ScenarioSelectView",setup:function(e){var t=(0,i.Pj)(),r=(0,u.rd)(),f=(0,d.s9)(),h=f.t,p=[{id:"main",name:h("scenario.categories.main")},{id:"side",name:h("scenario.categories.side")},{id:"extra",name:h("scenario.categories.extra")},{id:"custom",name:h("scenario.categories.custom")}],x=(0,c.KR)(null),ne=(0,c.KR)([]);(0,l.sV)((0,s.A)((0,a.A)().mark((function e(){var r,s,l,o;return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.loadAllScenarios();case 3:if(ne.value=e.sent,!t.getters["save/hasSave"]){e.next=11;break}if(s=null===(r=t.state.save.saveIndex)||void 0===r?void 0:r.currentScenario,!s){e.next=11;break}if(l=ne.value.find((function(e){return e.id===s})),!l){e.next=11;break}return x.value=l,e.abrupt("return");case 11:ne.value.length>0&&(o=(0,n.A)(ne.value).sort((function(e,t){return e.order-t.order})),x.value=o[0]),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),console.error("加载剧本列表失败:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))));var se=function(e){x.value=e},le=function(e){return e?v.u.getImageUrl("".concat(e,".png")):v.u.getImageUrl("default-cover.png")},oe=function(e){return null!==e&&void 0!==e&&e.coverPath?v.u.getImageUrl("".concat(e.coverPath,".png")):v.u.getImageUrl("default-thumbnail.png")},ce=function(e){var t={主线:"bg-tech-tag-story-bg text-tech-tag-story-text",必玩:"bg-tech-tag-combat-bg text-tech-tag-combat-text",番外:"bg-tech-tag-wits-bg text-tech-tag-wits-text",自创:"bg-tech-tag-puzzle-bg text-tech-tag-puzzle-text"};return t[e]||"bg-tech-tag-default-bg text-tech-tag-default-text"},ie=function(){var e=(0,s.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(x.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.dispatch("sections/SET_CURRENT_SCENARIO",x.value.id);case 5:return e.next=7,t.dispatch("sections/loadScenarioConfig");case 7:r.push("/character-select"),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("加载剧本失败:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){r.push("/")},de=function(e){return ne.value.filter((function(t){return t.category===e})).length},ve=function(e){return ne.value.filter((function(t){return t.category===e}))};return function(e,t){var r,a,n,s,i,u,d,v,f,b;return(0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("div",{class:"fixed inset-0 bg-cover bg-center z-0 bg-white w-full h-full",style:(0,o.Tr)({backgroundImage:"url(".concat(null!==(r=x.value)&&void 0!==r&&r.coverPath?le(x.value.coverPath):"",")")})},t[0]||(t[0]=[(0,l.Lk)("div",{class:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent to-white/90"},null,-1)]),4),(0,l.Lk)("div",g,[(0,l.Lk)("div",k,[t[1]||(t[1]=(0,l.Lk)("div",{class:"absolute inset-0 bg-white/50"},null,-1)),(0,l.Lk)("div",w,[(0,l.Lk)("img",{src:null!==(a=x.value)&&void 0!==a&&a.coverLargePath?le(x.value.coverLargePath):le("default-cover"),alt:(null===(n=x.value)||void 0===n?void 0:n.name)||"",class:"w-full h-full object-cover object-center"},null,8,y)]),t[2]||(t[2]=(0,l.Lk)("div",{class:"absolute inset-0 bg-gradient-to-t from-white/90 via-white/50 to-transparent"},null,-1)),(0,l.Lk)("div",L,[(0,l.Lk)("div",_,[(0,l.Lk)("h1",A,(0,o.v_)((null===(s=x.value)||void 0===s?void 0:s.name)||(0,c.R1)(h)("scenario.selectTitle")),1),(0,l.Lk)("p",C,(0,o.v_)((null===(i=x.value)||void 0===i?void 0:i.description)||(0,c.R1)(h)("scenario.selectDesc")),1),null!==(u=x.value)&&void 0!==u&&u.tags?((0,l.uX)(),(0,l.CE)("div",S,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(x.value.tags,(function(e){return(0,l.uX)(),(0,l.CE)("span",{key:e,class:(0,o.C4)(["px-3 py-1 rounded-full text-sm font-medium",ce(e)])},(0,o.v_)(e),3)})),128))])):(0,l.Q3)("",!0),null!==(d=x.value)&&void 0!==d&&d.author?((0,l.uX)(),(0,l.CE)("div",E,[(0,l.Lk)("span",I,(0,o.v_)((0,c.R1)(h)("scenario.author"))+":",1),(0,l.eW)(" "+(0,o.v_)(x.value.author),1)])):(0,l.Q3)("",!0),null!==(v=x.value)&&void 0!==v&&v.lastUpdate?((0,l.uX)(),(0,l.CE)("div",R,[(0,l.Lk)("div",null,[(0,l.Lk)("span",X,(0,o.v_)((0,c.R1)(h)("scenario.lastUpdate"))+":",1),(0,l.eW)(" "+(0,o.v_)(x.value.lastUpdate),1)]),null!==(f=x.value)&&void 0!==f&&f.updateNotes?((0,l.uX)(),(0,l.CE)("div",j,[(0,l.Lk)("span",P,(0,o.v_)((0,c.R1)(h)("scenario.updateNotes"))+":",1),(0,l.eW)(" "+(0,o.v_)(x.value.updateNotes),1)])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",T,[(0,l.Lk)("div",U,[(0,l.Lk)("h3",z,(0,o.v_)((0,c.R1)(h)("scenario.contentTags")),1),(0,l.Lk)("div",N,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(null===(b=x.value)||void 0===b?void 0:b.contentTags,(function(e){return(0,l.uX)(),(0,l.CE)("div",{key:e.type,class:(0,o.C4)(["flex flex-col items-center p-3 rounded-lg","bg-tech-content-".concat(e.type,"-bg text-tech-content-").concat(e.type,"-text")])},[(0,l.Lk)("span",K,(0,o.v_)(e.icon),1),(0,l.Lk)("span",F,(0,o.v_)(e.label),1)],2)})),128))])])])]),(0,l.Lk)("div",Q,[(0,l.Lk)("button",{onClick:ie,disabled:!x.value,class:"px-12 py-4 bg-tech-primary text-white text-responsive-lg font-medium rounded-2xl shadow-xl backdrop-blur-sm border border-white/20 transition-all duration-300 hover:bg-tech-primary/90 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-2xl"},(0,o.v_)((0,c.R1)(h)("scenario.start")),9,M)])]),(0,l.Lk)("div",O,[(0,l.Lk)("div",V,[(0,l.Lk)("div",W,[(0,l.Lk)("h2",B,(0,o.v_)((0,c.R1)(h)("scenario.library")),1),(0,l.Lk)("button",{onClick:ue,class:"flex items-center gap-2 text-tech-primary hover:text-tech-primary/80 transition-colors"},[(0,l.Lk)("span",D,(0,o.v_)((0,c.R1)(h)("scenario.returnToMenu")),1),t[3]||(t[3]=(0,l.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,l.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1))])]),(0,l.Lk)("div",J,[(0,l.Lk)("div",q,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(p,(function(e){return(0,l.Lk)("div",{key:e.id,class:"space-y-2"},[(0,l.Lk)("div",G,[(0,l.Lk)("h3",H,(0,o.v_)(e.name),1),(0,l.Lk)("span",Y,(0,o.v_)(de(e.id)),1)]),(0,l.Lk)("div",Z,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ve(e.id),(function(e){var t;return(0,l.uX)(),(0,l.CE)("button",{key:e.id,onClick:function(t){return se(e)},class:(0,o.C4)(["w-full p-4 rounded-2xl transition-all duration-300 hover:scale-[1.02]",(null===(t=x.value)||void 0===t?void 0:t.id)===e.id?"bg-tech-primary/10 border-2 border-tech-primary":"bg-white border-2 border-transparent hover:border-tech-primary/50"])},[(0,l.Lk)("div",ee,[(0,l.Lk)("div",te,[(0,l.Lk)("img",{src:oe(e),alt:e.name,class:"w-full h-full object-cover"},null,8,re)]),(0,l.Lk)("h3",ae,(0,o.v_)(e.shortName||e.name),1)])],10,$)})),128))])])})),64))])])])])])])}}});var se=r(6262);const le=(0,se.A)(ne,[["__scopeId","data-v-00e4551d"]]),oe=le}}]);