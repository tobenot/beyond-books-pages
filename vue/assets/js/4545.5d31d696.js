"use strict";(self["webpackChunkbeyond_books_vue"]=self["webpackChunkbeyond_books_vue"]||[]).push([[4545],{4545:(e,t,a)=>{a.r(t),a.d(t,{default:()=>se});var r=a(4048),n=a(9258),l=a(388),s=(a(2675),a(9463),a(8706),a(2008),a(113),a(4114),a(5086),a(6910),a(2010),a(6099),a(641)),o=a(33),c=a(953),i=a(6278),u=a(5220),d=a(6992),v=a(9410),h=a(1034),p=a(3604),f={scenarios:[{id:"silver_moon",path:"scenarios/silver_moon",category:"main",order:1}],loadAllScenarios:function(){var e=this;return(0,l.A)((0,r.A)().mark((function t(){var a,n,l,s,o,c;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,a=[],n=(0,p.A)(e.scenarios),t.prev=3,n.s();case 5:if((l=n.n()).done){t.next=20;break}return s=l.value,t.prev=7,t.next=10,v.u.loadJSON("".concat(s.path,"/config.json"));case 10:o=t.sent,c=(0,h.A)((0,h.A)((0,h.A)({},o),s),{},{coverPath:"".concat(s.path,"/thumbnail"),coverLargePath:"".concat(s.path,"/cover")}),a.push(c),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](7),console.error("加载剧本 ".concat(s.id," 失败:"),t.t0);case 18:t.next=5;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](3),n.e(t.t1);case 25:return t.prev=25,n.f(),t.finish(25);case 28:return a.sort((function(e,t){return e.order-t.order})),t.abrupt("return",a);case 32:return t.prev=32,t.t2=t["catch"](0),console.error("加载剧本列表失败:",t.t2),t.abrupt("return",[]);case 36:case"end":return t.stop()}}),t,null,[[0,32],[3,22,25,28],[7,15]])})))()},register:function(e){this.scenarios.push(e)}},x={loadAllScenarios:function(){return(0,l.A)((0,r.A)().mark((function e(){return(0,r.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",f.loadAllScenarios());case 1:case"end":return e.stop()}}),e)})))()}},g=a(6083),b={class:"min-h-screen bg-gradient-to-r from-white to-tech-light overflow-hidden"},m={class:"relative z-10 flex w-screen h-screen overflow-hidden"},k={class:"w-[65%] h-full relative flex flex-col"},w={class:"absolute inset-0"},y=["src","alt"],L={class:"relative flex-1 p-8 flex flex-col"},_={class:"flex-1 flex flex-col justify-end space-y-6 max-w-2xl"},C={class:"text-4xl font-bold text-tech-primary text-shadow-white-lg"},A={class:"text-lg text-tech-secondary text-shadow-white"},E={key:0,class:"flex flex-wrap gap-2"},R={key:1,class:"text-tech-secondary text-shadow-white"},S={class:"font-medium"},X={key:2,class:"text-tech-secondary space-y-1 text-shadow-white"},I={class:"font-medium"},j={key:0,class:"text-sm"},P={class:"font-medium"},z={class:"flex-none mt-4 mb-20"},U={class:"space-y-4"},N={class:"font-medium text-tech-secondary"},T={class:"flex flex-wrap gap-4"},K={class:"text-6xl mb-2"},F={class:"text-sm whitespace-nowrap"},W={class:"fixed bottom-12 left-1/2 -translate-x-1/2 z-50"},Q=["disabled"],O={class:"w-[35%] h-full bg-white"},V={class:"h-full flex flex-col"},H={class:"flex-none p-4 border-b border-gray-200 flex justify-between items-center text-responsive"},M={class:"text-xl font-bold text-tech-primary"},B={class:"flex-1 overflow-y-auto custom-scrollbar"},D={class:"p-4 space-y-6"},J={class:"flex items-center justify-between"},q={class:"text-responsive-lg font-medium text-tech-primary"},G={class:"text-responsive-sm text-tech-secondary"},Y={class:"space-y-2"},Z=["onClick"],$={class:"relative flex items-center gap-4"},ee={class:"w-32 h-32 flex-none rounded-xl overflow-hidden shadow-sm transition-all duration-300 group-hover:shadow-xl"},te=["src","alt"],ae={class:"flex-1 text-2xl font-medium text-tech-primary text-center transition-all duration-300 group-hover:text-tech-primary group-hover:scale-105"};const re=Object.assign({name:"ScenarioSelectView"},{__name:"ScenarioSelectView",setup:function(e){var t=(0,i.Pj)(),a=(0,u.rd)(),h=(0,d.s9)(),p=h.t,f=[{id:"main",name:p("scenario.categories.main")},{id:"side",name:p("scenario.categories.side")},{id:"extra",name:p("scenario.categories.extra")},{id:"custom",name:p("scenario.categories.custom")}],re=(0,c.KR)(null),ne=(0,c.KR)([]),le=(0,s.EW)((function(){return f.filter((function(e){return ne.value.some((function(t){return t.category===e.id}))}))}));(0,s.sV)((0,l.A)((0,r.A)().mark((function e(){var a,l,s,o;return(0,r.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.loadAllScenarios();case 3:if(ne.value=e.sent,!t.getters["save/hasSave"]){e.next=11;break}if(l=null===(a=t.state.save.saveIndex)||void 0===a?void 0:a.currentScenario,!l){e.next=11;break}if(s=ne.value.find((function(e){return e.id===l})),!s){e.next=11;break}return re.value=s,e.abrupt("return");case 11:ne.value.length>0&&(o=(0,n.A)(ne.value).sort((function(e,t){return e.order-t.order})),re.value=o[0]),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),console.error("加载剧本列表失败:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))));var se=function(e){var t;(null===(t=re.value)||void 0===t?void 0:t.id)!==e.id?re.value=e:ue()},oe=function(e){return e?v.u.getImageUrl("".concat(e,".png")):v.u.getImageUrl("default-cover.png")},ce=function(e){return null!==e&&void 0!==e&&e.coverPath?v.u.getImageUrl("".concat(e.coverPath,".png")):v.u.getImageUrl("default-thumbnail.png")},ie=function(e){var t={主线:"bg-tech-tag-story-bg text-tech-tag-story-text",必玩:"bg-tech-tag-combat-bg text-tech-tag-combat-text",番外:"bg-tech-tag-wits-bg text-tech-tag-wits-text",自创:"bg-tech-tag-puzzle-bg text-tech-tag-puzzle-text"};return t[e]||"bg-tech-tag-default-bg text-tech-tag-default-text"},ue=function(){var e=(0,l.A)((0,r.A)().mark((function e(){return(0,r.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(re.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.dispatch("sections/SET_CURRENT_SCENARIO",re.value.id);case 5:return e.next=7,t.dispatch("sections/loadScenarioConfig");case 7:a.push("/character-select"),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("加载剧本失败:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),de=function(){a.push("/")},ve=function(e){return ne.value.filter((function(t){return t.category===e})).length},he=function(e){return ne.value.filter((function(t){return t.category===e}))};return function(e,t){var a,r,n,l,i,u,d,v,h,f;return(0,s.uX)(),(0,s.CE)("div",b,[(0,s.Lk)("div",{class:"fixed inset-0 bg-cover bg-center z-0 bg-white w-full h-full",style:(0,o.Tr)({backgroundImage:"url(".concat(null!==(a=re.value)&&void 0!==a&&a.coverPath?oe(re.value.coverPath):"",")")})},t[0]||(t[0]=[(0,s.Lk)("div",{class:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent to-white/90"},null,-1)]),4),(0,s.Lk)("div",m,[(0,s.Lk)("div",k,[t[1]||(t[1]=(0,s.Lk)("div",{class:"absolute inset-0 bg-white/50"},null,-1)),(0,s.Lk)("div",w,[(0,s.Lk)("img",{src:null!==(r=re.value)&&void 0!==r&&r.coverLargePath?oe(re.value.coverLargePath):oe("default-cover"),alt:(null===(n=re.value)||void 0===n?void 0:n.name)||"",class:"w-full h-full object-cover object-center"},null,8,y)]),t[2]||(t[2]=(0,s.Lk)("div",{class:"absolute inset-0 bg-gradient-to-t from-white/90 via-white/50 to-transparent"},null,-1)),(0,s.Lk)("div",L,[(0,s.Lk)("div",_,[(0,s.Lk)("h1",C,(0,o.v_)((null===(l=re.value)||void 0===l?void 0:l.name)||(0,c.R1)(p)("scenario.selectTitle")),1),(0,s.Lk)("p",A,(0,o.v_)((null===(i=re.value)||void 0===i?void 0:i.description)||(0,c.R1)(p)("scenario.selectDesc")),1),null!==(u=re.value)&&void 0!==u&&u.tags?((0,s.uX)(),(0,s.CE)("div",E,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(re.value.tags,(function(e){return(0,s.uX)(),(0,s.CE)("span",{key:e,class:(0,o.C4)(["px-3 py-1 rounded-full text-sm font-medium text-shadow-white",ie(e)])},(0,o.v_)(e),3)})),128))])):(0,s.Q3)("",!0),null!==(d=re.value)&&void 0!==d&&d.author?((0,s.uX)(),(0,s.CE)("div",R,[(0,s.Lk)("span",S,(0,o.v_)((0,c.R1)(p)("scenario.author"))+":",1),(0,s.eW)(" "+(0,o.v_)(re.value.author),1)])):(0,s.Q3)("",!0),null!==(v=re.value)&&void 0!==v&&v.lastUpdate?((0,s.uX)(),(0,s.CE)("div",X,[(0,s.Lk)("div",null,[(0,s.Lk)("span",I,(0,o.v_)((0,c.R1)(p)("scenario.lastUpdate"))+":",1),(0,s.eW)(" "+(0,o.v_)(re.value.lastUpdate),1)]),null!==(h=re.value)&&void 0!==h&&h.updateNotes?((0,s.uX)(),(0,s.CE)("div",j,[(0,s.Lk)("span",P,(0,o.v_)((0,c.R1)(p)("scenario.updateNotes"))+":",1),(0,s.eW)(" "+(0,o.v_)(re.value.updateNotes),1)])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",z,[(0,s.Lk)("div",U,[(0,s.Lk)("h3",N,(0,o.v_)((0,c.R1)(p)("scenario.contentTags")),1),(0,s.Lk)("div",T,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(null===(f=re.value)||void 0===f?void 0:f.contentTags,(function(e){return(0,s.uX)(),(0,s.CE)("div",{key:e.type,class:(0,o.C4)(["flex flex-col items-center p-3 rounded-lg","bg-tech-content-".concat(e.type,"-bg text-tech-content-").concat(e.type,"-text")])},[(0,s.Lk)("span",K,(0,o.v_)(e.icon),1),(0,s.Lk)("span",F,(0,o.v_)(e.label),1)],2)})),128))])])])]),(0,s.Lk)("div",W,[(0,s.Lk)("button",{onClick:ue,disabled:!re.value,class:"px-12 py-4 bg-tech-primary text-white text-responsive-lg font-medium rounded-2xl shadow-xl backdrop-blur-sm border border-white/20 transition-all duration-300 hover:bg-tech-primary/90 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-2xl"},(0,o.v_)((0,c.R1)(p)("scenario.start")),9,Q)])]),(0,s.Lk)("div",O,[(0,s.Lk)("div",V,[(0,s.Lk)("div",H,[(0,s.Lk)("h2",M,(0,o.v_)((0,c.R1)(p)("scenario.library")),1),(0,s.bF)(g.A,{type:"ghost",onClick:de,class:"min-w-[7.5rem] text-responsive"},{icon:(0,s.k6)((function(){return t[3]||(t[3]=[(0,s.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor"},[(0,s.Lk)("path",{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"})],-1)])})),default:(0,s.k6)((function(){return[(0,s.eW)(" "+(0,o.v_)((0,c.R1)(p)("common.returnToMenu")),1)]})),_:1})]),(0,s.Lk)("div",B,[(0,s.Lk)("div",D,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(le.value,(function(e){return(0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"space-y-2"},[(0,s.Lk)("div",J,[(0,s.Lk)("h3",q,(0,o.v_)(e.name),1),(0,s.Lk)("span",G,(0,o.v_)(ve(e.id)),1)]),(0,s.Lk)("div",Y,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(he(e.id),(function(e){var a;return(0,s.uX)(),(0,s.CE)("button",{key:e.id,onClick:function(t){return se(e)},class:(0,o.C4)(["w-full p-4 rounded-2xl transition-all duration-300 bg-white border-2 group relative overflow-hidden hover:animate-card-hover",(null===(a=re.value)||void 0===a?void 0:a.id)===e.id?"border-tech-primary bg-tech-primary/5":"border-transparent hover:border-tech-primary"])},[t[4]||(t[4]=(0,s.Lk)("div",{class:"absolute inset-0 pointer-events-none bg-gradient-to-r from-transparent via-white/90 to-transparent translate-x-[-200%] group-hover:translate-x-[200%] transition-transform duration-700 ease-in-out"},null,-1)),(0,s.Lk)("div",$,[(0,s.Lk)("div",ee,[(0,s.Lk)("img",{src:ce(e),alt:e.name,class:"w-full h-full object-cover transition-all duration-300 group-hover:scale-110"},null,8,te)]),(0,s.Lk)("h3",ae,(0,o.v_)(e.shortName||e.name),1)])],10,Z)})),128))])])})),128))])])])])])])}}});var ne=a(6262);const le=(0,ne.A)(re,[["__scopeId","data-v-95185b04"]]),se=le}}]);