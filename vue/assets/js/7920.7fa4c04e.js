"use strict";(self["webpackChunkbeyond_books_vue"]=self["webpackChunkbeyond_books_vue"]||[]).push([[7920],{7920:(e,t,r)=>{r.r(t),r.d(t,{default:()=>le});var a=r(4048),n=r(9258),s=r(388),l=(r(2675),r(9463),r(8706),r(2008),r(113),r(4114),r(5086),r(6910),r(2010),r(6099),r(641)),o=r(33),c=r(953),i=r(6278),u=r(5220),v=r(6992),d=r(9410),p=r(1034),h=r(3604),f={scenarios:[{id:"silver_moon",path:"scenarios/silver_moon",category:"main",order:1}],loadAllScenarios:function(){var e=this;return(0,s.A)((0,a.A)().mark((function t(){var r,n,s,l,o,c;return(0,a.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,r=[],n=(0,h.A)(e.scenarios),t.prev=3,n.s();case 5:if((s=n.n()).done){t.next=20;break}return l=s.value,t.prev=7,t.next=10,d.u.loadJSON("".concat(l.path,"/config.json"));case 10:o=t.sent,c=(0,p.A)((0,p.A)((0,p.A)({},o),l),{},{coverPath:"".concat(l.path,"/thumbnail"),coverLargePath:"".concat(l.path,"/cover")}),r.push(c),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](7),console.error("加载剧本 ".concat(l.id," 失败:"),t.t0);case 18:t.next=5;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](3),n.e(t.t1);case 25:return t.prev=25,n.f(),t.finish(25);case 28:return r.sort((function(e,t){return e.order-t.order})),t.abrupt("return",r);case 32:return t.prev=32,t.t2=t["catch"](0),console.error("加载剧本列表失败:",t.t2),t.abrupt("return",[]);case 36:case"end":return t.stop()}}),t,null,[[0,32],[3,22,25,28],[7,15]])})))()},register:function(e){this.scenarios.push(e)}},x={loadAllScenarios:function(){return(0,s.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",f.loadAllScenarios());case 1:case"end":return e.stop()}}),e)})))()}},g={class:"min-h-screen bg-gradient-to-r from-white to-tech-light overflow-hidden"},b={class:"relative z-10 flex w-screen h-screen overflow-hidden"},m={class:"w-[65%] h-full relative flex flex-col"},k={class:"absolute inset-0"},w=["src","alt"],y={class:"relative flex-1 p-8 flex flex-col"},L={class:"flex-1 flex flex-col justify-end space-y-6 max-w-2xl"},_={class:"text-4xl font-bold text-tech-primary"},C={class:"text-lg text-tech-secondary"},A={key:0,class:"flex flex-wrap gap-2"},E={key:1,class:"text-tech-secondary"},R={class:"font-medium"},S={key:2,class:"text-tech-secondary space-y-1"},X={class:"font-medium"},I={key:0,class:"text-sm"},j={class:"font-medium"},P={class:"flex-none mt-4 mb-20"},U={class:"space-y-4"},z={class:"font-medium text-tech-secondary"},N={class:"flex flex-wrap gap-4"},T={class:"text-6xl mb-2"},K={class:"text-sm whitespace-nowrap"},F={class:"fixed bottom-12 left-1/2 -translate-x-1/2 z-50"},Q=["disabled"],W={class:"w-[35%] h-full bg-white"},M={class:"h-full flex flex-col"},O={class:"flex-none p-4 border-b border-gray-200 flex justify-between items-center text-responsive"},V={class:"text-xl font-bold text-tech-primary"},B={class:"text-responsive-sm"},D={class:"flex-1 overflow-y-auto custom-scrollbar"},J={class:"p-4 space-y-6"},q={class:"flex items-center justify-between"},G={class:"text-responsive-lg font-medium text-tech-primary"},H={class:"text-responsive-sm text-tech-secondary"},Y={class:"space-y-2"},Z=["onClick"],$={class:"relative flex items-center gap-4"},ee={class:"w-32 h-32 flex-none rounded-xl overflow-hidden shadow-sm transition-all duration-300 group-hover:shadow-xl"},te=["src","alt"],re={class:"flex-1 text-2xl font-medium text-tech-primary text-center transition-all duration-300 group-hover:text-tech-primary group-hover:scale-105"};const ae=Object.assign({name:"ScenarioSelectView"},{__name:"ScenarioSelectView",setup:function(e){var t=(0,i.Pj)(),r=(0,u.rd)(),p=(0,v.s9)(),h=p.t,f=[{id:"main",name:h("scenario.categories.main")},{id:"side",name:h("scenario.categories.side")},{id:"extra",name:h("scenario.categories.extra")},{id:"custom",name:h("scenario.categories.custom")}],ae=(0,c.KR)(null),ne=(0,c.KR)([]),se=(0,l.EW)((function(){return f.filter((function(e){return ne.value.some((function(t){return t.category===e.id}))}))}));(0,l.sV)((0,s.A)((0,a.A)().mark((function e(){var r,s,l,o;return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.loadAllScenarios();case 3:if(ne.value=e.sent,!t.getters["save/hasSave"]){e.next=11;break}if(s=null===(r=t.state.save.saveIndex)||void 0===r?void 0:r.currentScenario,!s){e.next=11;break}if(l=ne.value.find((function(e){return e.id===s})),!l){e.next=11;break}return ae.value=l,e.abrupt("return");case 11:ne.value.length>0&&(o=(0,n.A)(ne.value).sort((function(e,t){return e.order-t.order})),ae.value=o[0]),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),console.error("加载剧本列表失败:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))));var le=function(e){var t;(null===(t=ae.value)||void 0===t?void 0:t.id)!==e.id?ae.value=e:ue()},oe=function(e){return e?d.u.getImageUrl("".concat(e,".png")):d.u.getImageUrl("default-cover.png")},ce=function(e){return null!==e&&void 0!==e&&e.coverPath?d.u.getImageUrl("".concat(e.coverPath,".png")):d.u.getImageUrl("default-thumbnail.png")},ie=function(e){var t={主线:"bg-tech-tag-story-bg text-tech-tag-story-text",必玩:"bg-tech-tag-combat-bg text-tech-tag-combat-text",番外:"bg-tech-tag-wits-bg text-tech-tag-wits-text",自创:"bg-tech-tag-puzzle-bg text-tech-tag-puzzle-text"};return t[e]||"bg-tech-tag-default-bg text-tech-tag-default-text"},ue=function(){var e=(0,s.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(ae.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.dispatch("sections/SET_CURRENT_SCENARIO",ae.value.id);case 5:return e.next=7,t.dispatch("sections/loadScenarioConfig");case 7:r.push("/character-select"),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("加载剧本失败:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),ve=function(){r.push("/")},de=function(e){return ne.value.filter((function(t){return t.category===e})).length},pe=function(e){return ne.value.filter((function(t){return t.category===e}))};return function(e,t){var r,a,n,s,i,u,v,d,p,f;return(0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("div",{class:"fixed inset-0 bg-cover bg-center z-0 bg-white w-full h-full",style:(0,o.Tr)({backgroundImage:"url(".concat(null!==(r=ae.value)&&void 0!==r&&r.coverPath?oe(ae.value.coverPath):"",")")})},t[0]||(t[0]=[(0,l.Lk)("div",{class:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent to-white/90"},null,-1)]),4),(0,l.Lk)("div",b,[(0,l.Lk)("div",m,[t[1]||(t[1]=(0,l.Lk)("div",{class:"absolute inset-0 bg-white/50"},null,-1)),(0,l.Lk)("div",k,[(0,l.Lk)("img",{src:null!==(a=ae.value)&&void 0!==a&&a.coverLargePath?oe(ae.value.coverLargePath):oe("default-cover"),alt:(null===(n=ae.value)||void 0===n?void 0:n.name)||"",class:"w-full h-full object-cover object-center"},null,8,w)]),t[2]||(t[2]=(0,l.Lk)("div",{class:"absolute inset-0 bg-gradient-to-t from-white/90 via-white/50 to-transparent"},null,-1)),(0,l.Lk)("div",y,[(0,l.Lk)("div",L,[(0,l.Lk)("h1",_,(0,o.v_)((null===(s=ae.value)||void 0===s?void 0:s.name)||(0,c.R1)(h)("scenario.selectTitle")),1),(0,l.Lk)("p",C,(0,o.v_)((null===(i=ae.value)||void 0===i?void 0:i.description)||(0,c.R1)(h)("scenario.selectDesc")),1),null!==(u=ae.value)&&void 0!==u&&u.tags?((0,l.uX)(),(0,l.CE)("div",A,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ae.value.tags,(function(e){return(0,l.uX)(),(0,l.CE)("span",{key:e,class:(0,o.C4)(["px-3 py-1 rounded-full text-sm font-medium",ie(e)])},(0,o.v_)(e),3)})),128))])):(0,l.Q3)("",!0),null!==(v=ae.value)&&void 0!==v&&v.author?((0,l.uX)(),(0,l.CE)("div",E,[(0,l.Lk)("span",R,(0,o.v_)((0,c.R1)(h)("scenario.author"))+":",1),(0,l.eW)(" "+(0,o.v_)(ae.value.author),1)])):(0,l.Q3)("",!0),null!==(d=ae.value)&&void 0!==d&&d.lastUpdate?((0,l.uX)(),(0,l.CE)("div",S,[(0,l.Lk)("div",null,[(0,l.Lk)("span",X,(0,o.v_)((0,c.R1)(h)("scenario.lastUpdate"))+":",1),(0,l.eW)(" "+(0,o.v_)(ae.value.lastUpdate),1)]),null!==(p=ae.value)&&void 0!==p&&p.updateNotes?((0,l.uX)(),(0,l.CE)("div",I,[(0,l.Lk)("span",j,(0,o.v_)((0,c.R1)(h)("scenario.updateNotes"))+":",1),(0,l.eW)(" "+(0,o.v_)(ae.value.updateNotes),1)])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",P,[(0,l.Lk)("div",U,[(0,l.Lk)("h3",z,(0,o.v_)((0,c.R1)(h)("scenario.contentTags")),1),(0,l.Lk)("div",N,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(null===(f=ae.value)||void 0===f?void 0:f.contentTags,(function(e){return(0,l.uX)(),(0,l.CE)("div",{key:e.type,class:(0,o.C4)(["flex flex-col items-center p-3 rounded-lg","bg-tech-content-".concat(e.type,"-bg text-tech-content-").concat(e.type,"-text")])},[(0,l.Lk)("span",T,(0,o.v_)(e.icon),1),(0,l.Lk)("span",K,(0,o.v_)(e.label),1)],2)})),128))])])])]),(0,l.Lk)("div",F,[(0,l.Lk)("button",{onClick:ue,disabled:!ae.value,class:"px-12 py-4 bg-tech-primary text-white text-responsive-lg font-medium rounded-2xl shadow-xl backdrop-blur-sm border border-white/20 transition-all duration-300 hover:bg-tech-primary/90 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-2xl"},(0,o.v_)((0,c.R1)(h)("scenario.start")),9,Q)])]),(0,l.Lk)("div",W,[(0,l.Lk)("div",M,[(0,l.Lk)("div",O,[(0,l.Lk)("h2",V,(0,o.v_)((0,c.R1)(h)("scenario.library")),1),(0,l.Lk)("button",{onClick:ve,class:"flex items-center gap-2 text-tech-primary hover:text-tech-primary/80 transition-colors"},[(0,l.Lk)("span",B,(0,o.v_)((0,c.R1)(h)("scenario.returnToMenu")),1),t[3]||(t[3]=(0,l.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,l.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1))])]),(0,l.Lk)("div",D,[(0,l.Lk)("div",J,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(se.value,(function(e){return(0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"space-y-2"},[(0,l.Lk)("div",q,[(0,l.Lk)("h3",G,(0,o.v_)(e.name),1),(0,l.Lk)("span",H,(0,o.v_)(de(e.id)),1)]),(0,l.Lk)("div",Y,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(pe(e.id),(function(e){var r;return(0,l.uX)(),(0,l.CE)("button",{key:e.id,onClick:function(t){return le(e)},class:(0,o.C4)(["w-full p-4 rounded-2xl transition-all duration-300 bg-white border-2 group relative overflow-hidden hover:animate-card-hover",(null===(r=ae.value)||void 0===r?void 0:r.id)===e.id?"border-tech-primary bg-tech-primary/5":"border-transparent hover:border-tech-primary"])},[t[4]||(t[4]=(0,l.Lk)("div",{class:"absolute inset-0 pointer-events-none bg-gradient-to-r from-transparent via-white/90 to-transparent translate-x-[-200%] group-hover:translate-x-[200%] transition-transform duration-700 ease-in-out"},null,-1)),(0,l.Lk)("div",$,[(0,l.Lk)("div",ee,[(0,l.Lk)("img",{src:ce(e),alt:e.name,class:"w-full h-full object-cover transition-all duration-300 group-hover:scale-110"},null,8,te)]),(0,l.Lk)("h3",re,(0,o.v_)(e.shortName||e.name),1)])],10,Z)})),128))])])})),128))])])])])])])}}});var ne=r(6262);const se=(0,ne.A)(ae,[["__scopeId","data-v-4a4ba2b2"]]),le=se}}]);